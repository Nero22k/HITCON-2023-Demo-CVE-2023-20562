#pragma once
#include <stdio.h>
#include <windows.h>
#include <TlHelp32.h>
#include "ntdll.h"

#pragma comment(lib, "advapi32.lib")

#define SystemHandleInformation 16
#define STATUS_INFO_LENGTH_MISMATCH ((NTSTATUS)0xc0000004L)

typedef unsigned __int64 QWORD;

typedef NTSTATUS(WINAPI *_NtQuerySystemInformation)(ULONG SystemInformationClass, PVOID SystemInformation,
                                                    ULONG SystemInformationLength, PULONG ReturnLength);

DWORD getProcessId(WCHAR *process);
int spawnShell();
QWORD TokenAddressCurrentProcess(HANDLE hProcess, DWORD MyProcessID);
